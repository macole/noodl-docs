---
hide_title: true
hide_table_of_contents: true
title: レコード集計ノード
---

{/*##head##*/}

# レコード集計

このノードは、クラウドデータベース内のレコードのプロパティに対して集計を計算するために使用されます。

<div className="ndl-image-with-background l">

![](/nodes/cloud-functions/cloud-data/aggregate-records/aggregate-records.png)

</div>

集計を作成し、名前を付けます。

<div className="ndl-image-with-background l">

![](/nodes/cloud-functions/cloud-data/aggregate-records/props-1.png)

</div>

作成した各集計名に対して、集計するプロパティと集計の種類を選択します。

<div className="ndl-image-with-background l">

![](/nodes/cloud-functions/cloud-data/aggregate-records/props-2.png)

</div>

{/*##head##*/}

特定のセットのレコードに集計を限定するフィルターを指定することもできます。これは、[レコードクエリ](/nodes/data/cloud-data/query-records)ノードと同じ方法で行われます。詳細については、そのリファレンスドキュメントを参照してください。

**String** と **Number** の2種類のプロパティに対して集計を行うことができます。これらが利用可能な集計です：

**String**では、`Distinct` が唯一の集計であり、すべてのレコードのプロパティに対するユニークな値を返します。

**Number**では、以下の集計を使用できます：
- `Min` すべてのレコードにおけるプロパティの最小値を返します。
- `Max` すべてのレコードにおけるプロパティの最大値を返します。
- `Sum` すべてのレコードにおけるプロパティの合計を返します。
- `Avg` すべてのレコードにおけるプロパティの平均を返します。

## 入力

| データ                                                | 説明                                                                                                                                                                                                                                                                       |
| --------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span className="ndl-data">クラス</span>             | このノードが集計を行うレコードのタイプの**クラス**を選択します。**クラス**が選択されると、その**クラス**のフィルターや集計を作成できます。                                                                                                 |
| <span className="ndl-data">フィルター</span>            | フィルターの種類を指定します。以下から選択できます：<br/><br/>`Visual`: ビジュアルフィルターエディタを使用してフィルターを指定します。<br/>`JavaScript`: JavaScriptを使用してフィルターを指定します（これはより柔軟で、より動的なクエリを作成できますが、より複雑です） |
| <span className="ndl-data">クエリパラメータ</span>  | {/*##input:qp-\*##*/}クエリパラメータの値を指定するための入力です。{/*##input##*/} クエリで使用される各パラメータには、接続を介して値を提供できる入力があります。{/*##input##*/}                                                                          |
| <span className="ndl-data">集計</span>  | {/*##input:aggregates##*/}実行したい集計のリストです。ここには集計の結果を含む出力の名前を提供する必要があります。{/*##input##*/}                                                                          |

### 集計のプロパティと操作

作成した各集計には、集計するプロパティと使用する操作も指定する必要があります。

| データ                                                | 説明                                                                                                                                                                                                                                                                       |
| --------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span className="ndl-data">プロパティ</span>             | この集計が使用するべき**クラス**のプロパティを選択します。                                                                                                 |
| <span className="ndl-data">操作</span>            | 集計が使用すべき操作を選択します。どの操作がどのタイプに利用可能かについては上記を参照してください。 |


| シグナル                                 | 説明                                                                                                   |
| -------------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| <span className="ndl-signal">実行</span> | {/*##input:do##*/}ここにシグナルを送ると集計が実行されます。{/*##input##*/} |

## 出力

| データ                                              | 説明                                                                                                                                                                                          |
| ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span className="ndl-data">エラー</span>           | {/*##output:error##*/}何か問題が発生した場合にエラーメッセージを含む出力です。{/*##output##*/}                                                                           |

| シグナル                                      | 説明                                                                                                                                            |
| ------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| <span className="ndl-signal">成功</span> | {/*##output:success##*/}集計が成功し、結果が準備できた場合にここにシグナルが送られます。{/*##output##*/}                                             |
| <span className="ndl-signal">失敗</span> | {/*##output:failure##*/}集計に何か問題があった場合にここにシグナルが送られます。**エラー**出力を通じてエラーメッセージを見つけることができます。{/*##output##*/} |